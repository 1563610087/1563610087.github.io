<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ajax | UFO基地</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="Hello, my friend!">
    
    <link rel="preload" href="/assets/css/0.styles.d4bf95f4.css" as="style"><link rel="preload" href="/assets/js/app.ed392c7e.js" as="script"><link rel="preload" href="/assets/js/2.e61ebc2f.js" as="script"><link rel="preload" href="/assets/js/28.8e011d93.js" as="script"><link rel="prefetch" href="/assets/js/10.0c2a5e6f.js"><link rel="prefetch" href="/assets/js/11.65763309.js"><link rel="prefetch" href="/assets/js/12.62bd7cd5.js"><link rel="prefetch" href="/assets/js/13.84fd7b00.js"><link rel="prefetch" href="/assets/js/14.76172ee6.js"><link rel="prefetch" href="/assets/js/15.3ad856d8.js"><link rel="prefetch" href="/assets/js/16.3ac7f06b.js"><link rel="prefetch" href="/assets/js/17.65a246fc.js"><link rel="prefetch" href="/assets/js/18.cb772baf.js"><link rel="prefetch" href="/assets/js/19.f76cfbf3.js"><link rel="prefetch" href="/assets/js/20.dc8d8d82.js"><link rel="prefetch" href="/assets/js/21.687a969a.js"><link rel="prefetch" href="/assets/js/22.137fa288.js"><link rel="prefetch" href="/assets/js/23.14cbc642.js"><link rel="prefetch" href="/assets/js/24.0aeeb403.js"><link rel="prefetch" href="/assets/js/25.7fa9db84.js"><link rel="prefetch" href="/assets/js/26.44e82cd1.js"><link rel="prefetch" href="/assets/js/27.fa31f48f.js"><link rel="prefetch" href="/assets/js/29.ce077aa3.js"><link rel="prefetch" href="/assets/js/3.604382ba.js"><link rel="prefetch" href="/assets/js/30.79ecda02.js"><link rel="prefetch" href="/assets/js/31.ee3c01fc.js"><link rel="prefetch" href="/assets/js/32.c985f1e2.js"><link rel="prefetch" href="/assets/js/33.44200f11.js"><link rel="prefetch" href="/assets/js/34.c649ac18.js"><link rel="prefetch" href="/assets/js/35.2a6ddc50.js"><link rel="prefetch" href="/assets/js/36.bef21df1.js"><link rel="prefetch" href="/assets/js/37.01e1887e.js"><link rel="prefetch" href="/assets/js/38.6d4a1211.js"><link rel="prefetch" href="/assets/js/39.dde25747.js"><link rel="prefetch" href="/assets/js/4.b3d7061b.js"><link rel="prefetch" href="/assets/js/40.32c4bbff.js"><link rel="prefetch" href="/assets/js/41.da785b17.js"><link rel="prefetch" href="/assets/js/42.c3c277b4.js"><link rel="prefetch" href="/assets/js/5.abedb45c.js"><link rel="prefetch" href="/assets/js/6.73c063ed.js"><link rel="prefetch" href="/assets/js/7.b4e343ac.js"><link rel="prefetch" href="/assets/js/8.b05dfa12.js"><link rel="prefetch" href="/assets/js/9.823e2c0f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d4bf95f4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">UFO基地</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/guide/" class="nav-link">
  指南
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          前端基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/frontEnd/frontBase/html/htmlBase.html" class="nav-link">
  html
</a></li><li class="dropdown-subitem"><a href="/frontEnd/frontBase/css/cssBase.html" class="nav-link">
  css
</a></li><li class="dropdown-subitem"><a href="/frontEnd/frontBase/javascript/string.html" class="nav-link">
  javascript
</a></li></ul></li><li class="dropdown-item"><h4>
          前端框架
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/frontEnd/frontFrame/vue/vueBase.html" class="nav-link">
  vue
</a></li><li class="dropdown-subitem"><a href="/frontEnd/frontFrame/react/reactBase.html" class="nav-link">
  react
</a></li><li class="dropdown-subitem"><a href="/frontEnd/frontFrame/nodejs/nodejs.html" class="nav-link">
  nodejs
</a></li><li class="dropdown-subitem"><a href="/frontEnd/frontFrame/webpack/webpack.html" class="nav-link">
  webpack
</a></li></ul></li><li class="dropdown-item"><h4>
          web基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/frontEnd/webTech/browser/browser.html" class="nav-link">
  浏览器
</a></li><li class="dropdown-subitem"><a href="/frontEnd/webTech/ajax/ajax.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  ajax
</a></li><li class="dropdown-subitem"><a href="/frontEnd/webTech/http/http.html" class="nav-link">
  http
</a></li><li class="dropdown-subitem"><a href="/frontEnd/webTech/optimize/optimize.html" class="nav-link">
  性能优化
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/backEnd/" class="nav-link">
  后端
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="通用" class="dropdown-title"><span class="title">通用</span> <span class="arrow down"></span></button> <button type="button" aria-label="通用" class="mobile-dropdown-title"><span class="title">通用</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/normal/github/gitNotes.html" class="nav-link">
  git文档
</a></li><li class="dropdown-item"><!----> <a href="/normal/algorithm/dataStructure.html" class="nav-link">
  算法
</a></li><li class="dropdown-item"><!----> <a href="/normal/nginx/nginx.html" class="nav-link">
  nginx
</a></li><li class="dropdown-item"><!----> <a href="/normal/database/mysqlBase.html" class="nav-link">
  数据库
</a></li><li class="dropdown-item"><h4>
          编辑器
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/normal/editTool/idea/idea.html" class="nav-link">
  idea
</a></li><li class="dropdown-subitem"><a href="/normal/editTool/vscode/vscode.html" class="nav-link">
  vscode
</a></li><li class="dropdown-subitem"><a href="/normal/editTool/vim/vim.html" class="nav-link">
  vim
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="架构" class="dropdown-title"><span class="title">架构</span> <span class="arrow down"></span></button> <button type="button" aria-label="架构" class="mobile-dropdown-title"><span class="title">架构</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          前端架构
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/framework/frontFramework/webpack/webpack.html" class="nav-link">
  webpack
</a></li></ul></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/guide/" class="nav-link">
  指南
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          前端基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/frontEnd/frontBase/html/htmlBase.html" class="nav-link">
  html
</a></li><li class="dropdown-subitem"><a href="/frontEnd/frontBase/css/cssBase.html" class="nav-link">
  css
</a></li><li class="dropdown-subitem"><a href="/frontEnd/frontBase/javascript/string.html" class="nav-link">
  javascript
</a></li></ul></li><li class="dropdown-item"><h4>
          前端框架
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/frontEnd/frontFrame/vue/vueBase.html" class="nav-link">
  vue
</a></li><li class="dropdown-subitem"><a href="/frontEnd/frontFrame/react/reactBase.html" class="nav-link">
  react
</a></li><li class="dropdown-subitem"><a href="/frontEnd/frontFrame/nodejs/nodejs.html" class="nav-link">
  nodejs
</a></li><li class="dropdown-subitem"><a href="/frontEnd/frontFrame/webpack/webpack.html" class="nav-link">
  webpack
</a></li></ul></li><li class="dropdown-item"><h4>
          web基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/frontEnd/webTech/browser/browser.html" class="nav-link">
  浏览器
</a></li><li class="dropdown-subitem"><a href="/frontEnd/webTech/ajax/ajax.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  ajax
</a></li><li class="dropdown-subitem"><a href="/frontEnd/webTech/http/http.html" class="nav-link">
  http
</a></li><li class="dropdown-subitem"><a href="/frontEnd/webTech/optimize/optimize.html" class="nav-link">
  性能优化
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/backEnd/" class="nav-link">
  后端
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="通用" class="dropdown-title"><span class="title">通用</span> <span class="arrow down"></span></button> <button type="button" aria-label="通用" class="mobile-dropdown-title"><span class="title">通用</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/normal/github/gitNotes.html" class="nav-link">
  git文档
</a></li><li class="dropdown-item"><!----> <a href="/normal/algorithm/dataStructure.html" class="nav-link">
  算法
</a></li><li class="dropdown-item"><!----> <a href="/normal/nginx/nginx.html" class="nav-link">
  nginx
</a></li><li class="dropdown-item"><!----> <a href="/normal/database/mysqlBase.html" class="nav-link">
  数据库
</a></li><li class="dropdown-item"><h4>
          编辑器
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/normal/editTool/idea/idea.html" class="nav-link">
  idea
</a></li><li class="dropdown-subitem"><a href="/normal/editTool/vscode/vscode.html" class="nav-link">
  vscode
</a></li><li class="dropdown-subitem"><a href="/normal/editTool/vim/vim.html" class="nav-link">
  vim
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="架构" class="dropdown-title"><span class="title">架构</span> <span class="arrow down"></span></button> <button type="button" aria-label="架构" class="mobile-dropdown-title"><span class="title">架构</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          前端架构
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/framework/frontFramework/webpack/webpack.html" class="nav-link">
  webpack
</a></li></ul></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/frontEnd/webTech/ajax/ajax.html" aria-current="page" class="active sidebar-link">ajax</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/frontEnd/webTech/ajax/ajax.html#_1-概述" class="sidebar-link">1 概述</a></li><li class="sidebar-sub-header"><a href="/frontEnd/webTech/ajax/ajax.html#_2-创建ajax请求" class="sidebar-link">2 创建ajax请求</a></li><li class="sidebar-sub-header"><a href="/frontEnd/webTech/ajax/ajax.html#_3-axios" class="sidebar-link">3 axios</a></li><li class="sidebar-sub-header"><a href="/frontEnd/webTech/ajax/ajax.html#_4-vue-resource" class="sidebar-link">4 vue-resource</a></li><li class="sidebar-sub-header"><a href="/frontEnd/webTech/ajax/ajax.html#_5-jquery中的ajax" class="sidebar-link">5 jquery中的ajax</a></li><li class="sidebar-sub-header"><a href="/frontEnd/webTech/ajax/ajax.html#_6-json" class="sidebar-link">6 json</a></li><li class="sidebar-sub-header"><a href="/frontEnd/webTech/ajax/ajax.html#_7-fetch" class="sidebar-link">7 fetch</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="ajax"><a href="#ajax" class="header-anchor">#</a> ajax</h1> <h2 id="_1-概述"><a href="#_1-概述" class="header-anchor">#</a> 1 概述</h2> <h3 id="_1-1-浏览器发送请求方式"><a href="#_1-1-浏览器发送请求方式" class="header-anchor">#</a> 1.1 浏览器发送请求方式</h3> <ul><li>地址栏输入地址，回车，刷新</li> <li>特定元素的 href 或 src 属性</li> <li>表单提交</li></ul> <p>缺点：这些方案都是我们无法通过或者很难通过代码的方式进行编程（对服务端发出请求并且接受服务端返回的响应）</p> <h3 id="_1-2-ajax"><a href="#_1-2-ajax" class="header-anchor">#</a> 1.2 ajax</h3> <p>A JAX（Asynchronous JavaScript and XML），最早出现在 2005 年的 Google Suggest，是在浏览器端进行网络编程（发送请求、接收响应）的技术方案，它使我们可以通过 JavaScript 直接获取服务端最新的内容而不必重新加载页面。让 Web 更能接近桌面应用的用户体验</p> <p>A JAX 就是浏览器提供的一套 API，可以通过 JavaScript 调用，从而实现通过代码控制请求与响应。实现网络编程。</p> <h2 id="_2-创建ajax请求"><a href="#_2-创建ajax请求" class="header-anchor">#</a> 2 创建ajax请求</h2> <h3 id="_2-1-基本用法"><a href="#_2-1-基本用法" class="header-anchor">#</a> 2.1 基本用法</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 1. 创建一个 XMLHttpRequest 类型的对象 </span>
<span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 2. 打开与一个网址之间的连接,设置请求方式，请求的地址</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'请求地址'</span><span class="token punctuation">)</span>
<span class="token comment">// 3. 通过连接发送请求 </span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>发送内容<span class="token punctuation">)</span>
<span class="token comment">// 4. 指定 xhr 状态变化事件处理函数 </span>
xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">// 通过 xhr 的 readyState 判断此次请求的响应是否接收完成</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">// 通过 xhr 的 responseText 获取到响应的响应体</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-2-readystate-状态"><a href="#_2-2-readystate-状态" class="header-anchor">#</a> 2.2 readyState 状态</h3> <table><thead><tr><th>readyState</th> <th>状态描述</th> <th>说明</th></tr></thead> <tbody><tr><td>0</td> <td>unsent</td> <td>代理xhr被创建，但未调用open（）方法</td></tr> <tr><td>1</td> <td>opened</td> <td>open（）方法已经被调用，建立了连接</td></tr> <tr><td>2</td> <td>headers_received</td> <td>send()方法已经被调用，并且可以获得状态行和响应头</td></tr> <tr><td>3</td> <td>loading</td> <td>响应体下载中，responseText属性可能已经包含部分数据</td></tr> <tr><td>4</td> <td>done</td> <td>响应体下载完成，可以直接使用responseText</td></tr></tbody></table> <h3 id="_2-3-遵循http"><a href="#_2-3-遵循http" class="header-anchor">#</a> 2.3 遵循http</h3> <p>本质上 XMLHttpRequest 就是 JavaScript 在 Web 平台中发送 HTTP 请求的手段，所以我们发送出去的请求任然是
HTTP 请求，同样符合 HTTP 约定的格式：
参考链接：
https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest
https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest/Using_XMLHttpRequest</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//具体用法</span>
xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">// 后续逻辑......</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 设置请求报文的请求行</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'./time.php'</span><span class="token punctuation">)</span>
<span class="token comment">// 设置请求头</span>
xhr<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">'Accept'</span><span class="token punctuation">,</span> <span class="token string">'text/plain'</span><span class="token punctuation">)</span>
<span class="token comment">// 设置请求体</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">// 获取响应状态码</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>status<span class="token punctuation">)</span>
<span class="token comment">// 获取响应状态描述</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>statusText<span class="token punctuation">)</span>
<span class="token comment">// 获取响应头信息</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getResponseHeader</span><span class="token punctuation">(</span><span class="token string">'Content‐Type'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 指定响应头</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAllResponseHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 全部响应头</span>
<span class="token comment">// 获取响应体</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>responseText<span class="token punctuation">)</span> <span class="token comment">// 文本形式</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>responseXML<span class="token punctuation">)</span> <span class="token comment">// XML 形式，了解即可不用了</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span> 
</code></pre></div><h2 id="_3-axios"><a href="#_3-axios" class="header-anchor">#</a> 3 axios</h2> <h3 id="_3-1-安装"><a href="#_3-1-安装" class="header-anchor">#</a> 3.1 安装</h3> <p>vue本身不支持发送AJAX请求，需要使用vue-resource、axios等插件实现
axios是一个基于Promise的HTTP请求客户端，用来发送请求，也是vue2.0官方推荐的，同时不再对vue-resource进行更新和维护</p> <p>axios基于promise，可以调用promise的then()和catch()等方法，看下面的例子</p> <p>参考：GitHub上搜索axios，查看API文档</p> <ul><li>npm install axios -S
也可直接下载axios.min.js文件</li></ul> <h3 id="_3-2-基本用法"><a href="#_3-2-基本用法" class="header-anchor">#</a> 3.2 基本用法</h3> <h4 id="axios-config"><a href="#axios-config" class="header-anchor">#</a> axios([config])</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//发送post请求</span>
<span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  method<span class="token operator">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
  url<span class="token operator">:</span> <span class="token string">'/user/12345'</span><span class="token punctuation">,</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    firstName<span class="token operator">:</span> <span class="token string">'Fred'</span><span class="token punctuation">,</span>
    lastName<span class="token operator">:</span> <span class="token string">'Flintstone'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//发送get请求</span>
<span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  method<span class="token operator">:</span><span class="token string">'get'</span><span class="token punctuation">,</span>
  url<span class="token operator">:</span><span class="token string">'http://bit.ly/2mTM3nY'</span><span class="token punctuation">,</span>
  responseType<span class="token operator">:</span><span class="token string">'stream'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    response<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span><span class="token string">'ada_lovelace.jpg'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="axios-get-url-config"><a href="#axios-get-url-config" class="header-anchor">#</a> axios.get(url,[config])</h4> <ul><li><p>传参方式：</p></li> <li><p>通过url传参
axios.get('server.php?name=tom&amp;age=23')
请求地址加上？后面的参数拼接</p></li> <li><p>通过params选项传参</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>	axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'server.php'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
		params<span class="token operator">:</span><span class="token punctuation">{</span>
			name<span class="token operator">:</span><span class="token string">'alice'</span><span class="token punctuation">,</span>
			age<span class="token operator">:</span><span class="token number">19</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">resp</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>resp<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'请求失败：'</span><span class="token operator">+</span>err<span class="token punctuation">.</span>status<span class="token operator">+</span><span class="token string">','</span><span class="token operator">+</span>err<span class="token punctuation">.</span>statusText<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div></li></ul> <h4 id="axios-post-url-data-config"><a href="#axios-post-url-data-config" class="header-anchor">#</a> axios.post(url,data,[config])</h4> <p>​    <strong>axios默认发送数据时，数据格式是Request Payload，并非我们常用的Form Data格式</strong>，</p> <p>所以参数必须要以键值对形式传递，不能以json形式传参</p> <div class="language- extra-class"><pre class="language-text"><code>采用node.js中，express框架已经可以接收axios的post form data传参方式,采用req.body接收
</code></pre></div><ul><li><p>传参方式：
1.自己拼接为键值对
2.使用transformRequest，在请求发送前将请求数据进行转换
3.如果使用模块化开发，可以使用qs模块进行转换</p></li> <li><p>案例</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'server.php'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
	name<span class="token operator">:</span><span class="token string">'alice'</span><span class="token punctuation">,</span>
	age<span class="token operator">:</span><span class="token number">19</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//这种形式post传参获取不到</span>

<span class="token comment">//方案1 自己拼接为键值对</span>
 axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'server.php'</span><span class="token punctuation">,</span><span class="token string">'name=alice&amp;age=20&amp;'</span><span class="token punctuation">)</span>

<span class="token comment">//方案2  使用transformRequest，在请求发送前将请求数据进行转换</span>
axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'server.php'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>user<span class="token punctuation">,</span><span class="token punctuation">{</span>
	<span class="token comment">//这里的this.user是vue要传递的参数，在传递前，将this.user的数据放入transformRequest的函数	//function中，将数据传给形参data</span>
    transformRequest<span class="token operator">:</span><span class="token punctuation">[</span>
		<span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">let</span> params<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> index <span class="token keyword">in</span> data<span class="token punctuation">)</span><span class="token punctuation">{</span>
			params<span class="token operator">+=</span>index<span class="token operator">+</span><span class="token string">'='</span><span class="token operator">+</span>data<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'&amp;'</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> params<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//方案3 如果使用模块化开发，可以使用qs模块进行转换    </span>
</code></pre></div></li></ul> <p><strong>注意：</strong></p> <p>axios本身并不支持发送跨域的请求，没有提供相应的API，作者也暂没计划在axios添加支持发送跨域请求，所以只能使用第三方库</p> <h3 id="_3-3-优点"><a href="#_3-3-优点" class="header-anchor">#</a> 3.3 优点</h3> <ul><li>从浏览器中创建XMLHttpRequest</li> <li>从node.js 中发出http请求</li> <li>支持 Promise API</li> <li>客户端支持防止CSRF（伪脚本攻击）
-提供了并发请求API接口</li> <li>支持请求/响应拦截</li> <li>取消请求
-自动转换json数据</li></ul> <h3 id="_3-4-axios拦截器"><a href="#_3-4-axios拦截器" class="header-anchor">#</a> 3.4 axios拦截器</h3> <p>一般在使用axios时，会用到拦截器的功能，一般分为两种：<code>请求拦截器</code>、 <code>响应拦截器</code>。</p> <ul><li><strong>请求拦截器</strong> 在请求发送前进行必要操作处理，例如添加统一cookie、请求体加验证、设置请求头等，相当于是对每个接口里相同操作的一个封装；</li> <li><strong>响应拦截器</strong> 同理，响应拦截器也是如此功能，只是在请求得到响应之后，对响应体的一些处理，例如数据统一处理，错误统一处理等，也常来判断登录失效等。</li></ul> <p>1 创建拦截器实例</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span>

<span class="token comment">//  这个是常用的配置项</span>
<span class="token keyword">let</span> baseURL<span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span><span class="token string">'development'</span><span class="token punctuation">)</span>
 <span class="token punctuation">{</span> baseURL <span class="token operator">=</span> <span class="token string">'xxx本地环境xxx'</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
 <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'production'</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> 
   baseURL <span class="token operator">=</span> <span class="token string">'xxx生产环境xxx'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//创建实例</span>
<span class="token keyword">let</span> instance <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    baseURL<span class="token operator">:</span> <span class="token string">'xxxxxxxxxx'</span><span class="token punctuation">,</span>
    timeout<span class="token operator">:</span><span class="token number">15000</span><span class="token comment">// 毫秒</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>2 请求拦截器</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">request</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//发送请求之前配置请求项</span>
    <span class="token keyword">return</span> request<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 请求错误时的操作</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>3 响应拦截器</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Any status code that lie within the range of 2xx cause this function to trigger</span>
    <span class="token comment">// Do something with response data</span>
    <span class="token keyword">return</span> response<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Any status codes that falls outside the range of 2xx cause this function to trigger</span>
    <span class="token comment">// Do something with response error</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_4-vue-resource"><a href="#_4-vue-resource" class="header-anchor">#</a> 4 vue-resource</h2> <h3 id="_4-1-发送跨域请求"><a href="#_4-1-发送跨域请求" class="header-anchor">#</a> 4.1 发送跨域请求</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>使用<span class="token keyword">this</span><span class="token punctuation">.</span>$http发送请求  
    <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">head</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">jsonp</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">[</span>body<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">[</span>body<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">patch</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">[</span>body<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span><span class="token punctuation">)</span>  
</code></pre></div><h2 id="_5-jquery中的ajax"><a href="#_5-jquery中的ajax" class="header-anchor">#</a> 5 jquery中的ajax</h2> <p>jQuery 中有一套专门针对 A JAX 的封装，功能十分完善，经常使用，需要着重注意。
参考：
http://www.jquery123.com/category/ajax/
http://www.w3school.com.cn/jquery/jquery_ref_ajax.asp</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>$<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
url<span class="token operator">:</span> <span class="token string">'./get.php'</span><span class="token punctuation">,</span>
type<span class="token operator">:</span> <span class="token string">'get'</span><span class="token punctuation">,</span>
dataType<span class="token operator">:</span> <span class="token string">'json'</span><span class="token punctuation">,</span>
data<span class="token operator">:</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function-variable function">beforeSend</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">xhr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'before send'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function-variable function">error</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function-variable function">complete</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'request completed'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>常用选项参数介绍：
url：请求地址
type：请求方法，默认为 get
dataType：服务端响应数据类型
contentType：请求体内容类型，默认 application/x-www-form-urlencoded
data：需要传递到服务端的数据，如果 GET 则通过 URL 传递，如果 POST 则通过请求体传递
timeout：请求超时时间
beforeSend：请求发起之前触发
success：请求成功之后触发（响应状态码 200）
error：请求失败触发
complete：请求完成触发（不管成功与否）
</code></pre></div><h2 id="_6-json"><a href="#_6-json" class="header-anchor">#</a> 6 json</h2> <h3 id="_1-概念"><a href="#_1-概念" class="header-anchor">#</a> 1 概念</h3> <p>* JS中的对象只有JS自己认识，其他的语言都不认识
* JSON就是一个特殊格式的字符串，这个字符串可以被任意的语言所识别，
* 并且可以转换为任意语言中的对象，JSON在开发中主要用来数据的交互</p> <h3 id="_2-语法"><a href="#_2-语法" class="header-anchor">#</a> 2 语法</h3> <h4 id="_2-1语法规则"><a href="#_2-1语法规则" class="header-anchor">#</a> 2.1<strong>语法规则</strong></h4> <div class="language- extra-class"><pre class="language-text"><code>JSON 语法是 JavaScript 对象表示语法的子集。
数据在名称/值对中,属性必须用双引号包起来
数据由逗号分隔大括号保存对象
中括号保存数组
</code></pre></div><p><strong>分类</strong>
1 对象{}</p> <div class="language- extra-class"><pre class="language-text"><code>{&quot;name&quot;:&quot;小明&quot;，&quot;age&quot;:&quot;12&quot;}
</code></pre></div><p>2 数组[]</p> <div class="language- extra-class"><pre class="language-text"><code> [
 { &quot;name&quot;:&quot;runoob&quot; , &quot;url&quot;:&quot;www.runoob.com&quot; },
 { &quot;name&quot;:&quot;google&quot; , &quot;url&quot;:&quot;www.google.com&quot; }, 
 { &quot;name&quot;:&quot;微博&quot; , &quot;url&quot;:&quot;www.weibo.com&quot; } 
 ]
</code></pre></div><h4 id="_2-2-json的值类型"><a href="#_2-2-json的值类型" class="header-anchor">#</a> 2.2 json的值类型</h4> <p>数字（整数或浮点数）
字符串（在双引号中）
逻辑值（true 或 false）
数组（在中括号中）
对象（在大括号中）为普通的对象，不包含函数类的对象
null</p> <h3 id="_3-json格式转换"><a href="#_3-json格式转换" class="header-anchor">#</a> 3 json格式转换</h3> <h4 id="_3-1-js对象转json格式"><a href="#_3-1-js对象转json格式" class="header-anchor">#</a> 3.1 js对象转json格式</h4> <p>JSON 通常用于与服务端交换数据。在向服务器发送数据时一般是字符串。我们可以使用 JSON.stringify() 方法将 JavaScript 对象转换为字符串
<strong>JSON.stringify</strong></p> <div class="language- extra-class"><pre class="language-text"><code>var obj3 = {name:&quot;猪八戒&quot; , age:28 , gender:&quot;男&quot;};
var str = JSON.stringify(obj3);
console.log(str)
</code></pre></div><h4 id="_3-2-json格式转js对象"><a href="#_3-2-json格式转js对象" class="header-anchor">#</a> 3.2 json格式转js对象</h4> <p><strong>JSON.parse</strong></p> <div class="language- extra-class"><pre class="language-text"><code>var json = '{&quot;name&quot;:&quot;孙悟空&quot;,&quot;age&quot;:18,&quot;gender&quot;:&quot;男&quot;}';
var o = JSON.parse(json);
console.log(o)
</code></pre></div><h3 id="_4-json-parse和json-stringify兼容性"><a href="#_4-json-parse和json-stringify兼容性" class="header-anchor">#</a> 4 jSON.parse和JSON.stringify兼容性</h3> <div class="language- extra-class"><pre class="language-text"><code>Firefox 3.5
Internet Explorer 8
Chrome
Opera 10
Safari 4
</code></pre></div><h3 id="_5-eval-函数"><a href="#_5-eval-函数" class="header-anchor">#</a> 5 eval()函数</h3> <ol><li>这个函数可以用来执行一段字符串形式的JS代码，并将执行结果返回</li> <li>如果使用eval()执行的字符串中含有{},它会将{}当成是代码块
3.如果不希望将其当成代码块解析，则需要在字符串前后各加一个()
4.eval()这个函数的功能很强大，可以直接执行一个字符串中的js代码，
5.但是在开发中尽量不要使用，首先它的执行性能比较差，然后它还具有安全隐患</li></ol> <h3 id="_6-json优点"><a href="#_6-json优点" class="header-anchor">#</a> 6 json优点</h3> <p>对于 AJAX 应用程序来说，JSON 比 XML 更快更易使用：
<strong>使用 XML</strong>
读取 XML 文档
使用 XML DOM 来循环遍历文档
读取值并存储在变量中
<strong>使用 JSON</strong>
读取 JSON 字符串
用 eval() 处理 JSON 字符串
<strong>与 XML 相同之处</strong></p> <p>JSON 是纯文本JSON 具有&quot;自我描述性&quot;（人类可读）JSON 具有层级结构（值中存在值）
JSON 可通过 JavaScript 进行解析
JSON 数据可使用 AJAX 进行传输
<strong>与 XML 不同之处</strong>
没有结束标签
更短读写的速度
更快能够使用内建的 JavaScript eval() 方法进行解析使
用数组不使用保留字</p> <h2 id="_7-fetch"><a href="#_7-fetch" class="header-anchor">#</a> 7 fetch</h2> <p>fetch号称是ajax的替代品，它的API是基于Promise设计的，旧版本的浏览器不支持Promise，需要使用polyfill es6-promise</p> <p>举个例子：</p> <div class="language- extra-class"><pre class="language-text"><code>// 原生XHR
var xhr = new XMLHttpRequest();
xhr.open('GET', url);
xhr.onreadystatechange = function() {
    if (xhr.readyState === 4 &amp;&amp; xhr.status === 200) {
        console.log(xhr.responseText)   // 从服务器获取数据
    }
}
xhr.send()
// fetch
fetch(url)
    .then(response =&gt; {
        if (response.ok) {
            return response.json();
        }
    })
    .then(data =&gt; console.log(data))
    .catch(err =&gt; console.log(err))
复制代码
</code></pre></div><p>看起来好像是方便点，then链就像之前熟悉的callback。</p> <p>在MDN上，讲到它跟jquery ajax的区别，这也是fetch很奇怪的地方：</p> <blockquote><p>当接收到一个代表错误的 HTTP 状态码时，从 fetch()返回的 Promise 不会被标记为 reject， 即使该 HTTP 响应的状态码是 404 或 500。相反，它会将 Promise 状态标记为 resolve （但是会将 resolve 的返回值的 ok 属性设置为 false ），  仅当网络故障时或请求被阻止时，才会标记为 reject。 默认情况下, fetch 不会从服务端发送或接收任何 cookies, 如果站点依赖于用户 session，则会导致未经认证的请求（要发送 cookies，必须设置 credentials 选项）.</p></blockquote> <p>突然感觉这还不如jquery ajax好用呢？别急，再搭配上async/await将会让我们的异步代码更加优雅：</p> <div class="language- extra-class"><pre class="language-text"><code>async function test() {
    let response = await fetch(url);
    let data = await response.json();
    console.log(data)
}
复制代码
</code></pre></div><p>看起来是不是像同步代码一样？简直完美！好吧，其实并不完美，async/await是ES7的API，目前还在试验阶段，还需要我们使用babel进行转译成ES5代码。</p> <p>还要提一下的是，fetch是比较底层的API，很多情况下都需要我们再次封装。 比如：</p> <div class="language- extra-class"><pre class="language-text"><code>// jquery ajax
$.post(url, {name: 'test'})
// fetch
fetch(url, {
    method: 'POST',
    body: Object.keys({name: 'test'}).map((key) =&gt; {
        return encodeURIComponent(key) + '=' + encodeURIComponent(params[key]);
    }).join('&amp;')
})
复制代码
</code></pre></div><p>由于fetch是比较底层的API，所以需要我们手动将参数拼接成'name=test'的格式，而jquery ajax已经封装好了。所以fetch并不是开箱即用的。</p> <p>另外，fetch还不支持超时控制。</p> <h3 id="_7-2-缺点"><a href="#_7-2-缺点" class="header-anchor">#</a> 7.2 缺点</h3> <p>符合关注分离，没有将输入、输出和用事件来跟踪的状态混杂在一个对象里
更好更方便的写法
更加底层，提供的API丰富（request, response）
脱离了XHR，是ES规范里新的实现方式
1）fetchtch只对网络请求报错，对400，500都当做成功的请求，需要封装去处理
2）fetch默认不会带cookie，需要添加配置项
3）fetch不支持abort，不支持超时控制，使用setTimeout及Promise.reject的实现的超时控制并不能阻止请求过程继续在后台运行，造成了量的浪费
4）fetch没有办法原生监测请求的进度，而XHR可以</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.ed392c7e.js" defer></script><script src="/assets/js/2.e61ebc2f.js" defer></script><script src="/assets/js/28.8e011d93.js" defer></script>
  </body>
</html>
